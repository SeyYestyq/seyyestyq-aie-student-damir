# Отчет по домашнему заданию HW07 (Кластеризация)


## 1. Сводная таблица результатов

Ниже представлены метрики для выбранных ("лучших") конфигураций алгоритмов по каждому датасету.

| Датасет | Лучший алгоритм | Параметры | Silhouette Score | Davies-Bouldin | Calinski-Harabasz | % Шума (для DBSCAN) |
|---|---|---|---|---|---|---|
| **Dataset 01** | KMeans | `k=3` | 0.3968 | 0.9646 | 10446.6 | — |
| **Dataset 02** | DBSCAN | `eps=0.8`, `min_samples=10` | 0.4138 | 0.7960 | ~1450.0 | 1.2% |
| **Dataset 04** | DBSCAN | `eps=3.0`, `min_samples=5` | 0.4559 | 0.9515 | 5346.1 | ~2.0% |


## 2. Анализ по каждому датасету

### 2.1. S07-hw-dataset-01.csv
* **Характеристика данных:** Датасет содержит 3 явно выраженных, выпуклых (сферических) кластера.
* **Выбранное решение:** **KMeans (k=3)**.
* **Обоснование:**
    * Алгоритм показал высокий `Silhouette Score` (~0.40).
    * **Проверка устойчивости:** При 5 запусках с разными `random_state` метрика ARI составила **1.0**, что говорит об абсолютной устойчивости решения.
    * DBSCAN также справлялся с задачей, но KMeans здесь предпочтительнее как более простая и интерпретируемая модель для выпуклых кластеров.

### 2.2. S07-hw-dataset-02.csv
* **Характеристика данных:** Кластеры имеют сложную геометрическую форму (не выпуклую) или расположены близко друг к другу.
* **Выбранное решение:** **DBSCAN (eps=0.8, min_samples=10)**.
* **Обоснование:**
    * KMeans (`k=3`) показал низкий результат (`Silhouette` ~0.27), так как пытался аппроксимировать сложные формы шарами.
    * Стандартный DBSCAN (`eps=0.5`) давал слишком много шума или разбивал кластеры на части (отрицательный силуэт).
    * Увеличение радиуса поиска до `eps=0.8` и требования к плотности (`min_samples=10`) позволило корректно объединить точки в плотные группы, подняв `Silhouette` до 0.41.

### 2.3. S07-hw-dataset-04.csv
* **Характеристика данных:** Высокая размерность (30 признаков), наличие пропусков (были заполнены средним).
* **Выбранное решение:** **DBSCAN (eps=3.0, min_samples=5)**.
* **Обоснование:**
    * Здесь проявилось **"проклятие размерности"**. При стандартных настройках (`eps=0.5`) DBSCAN пометил 100% данных как шум, так как в многомерном пространстве точки становятся более разреженными.
    * KMeans показал посредственный результат (`Silhouette` ~0.30).
    * Кардинальное увеличение радиуса до `eps=3.0` позволило алгоритму найти соседей. Итоговое разбиение оказалось самым качественным среди всех экспериментов (`Silhouette` ~0.46), что подтверждает наличие сложной структуры, недоступной для KMeans.

---

## 3. Визуализация и интерпретация

Графики сохранены в папке `artifacts/figures/`.

1.  **PCA (2D Scatter):**
    * На всех датасетах PCA-проекция подтверждает адекватность выбранного разбиения: точки одного цвета группируются вместе.
    * Особенно показателен случай Dataset 04, где даже после снижения размерности с 30 до 2 видна четкая структура кластеров.

2.  **Графики подбора параметров:**
    * Для KMeans четко виден "локоть" или пик силуэта на `k=3`.
    * Для DBSCAN графики показали, что оптимумы `eps` находятся далеко от стандартных значений (особенно для Dataset 04).

---

## 4. Выводы

В ходе выполнения работы были сделаны следующие выводы:

1.  **Важность EDA и предобработки:** Для Dataset 04 потребовалась импутация пропусков, а масштабирование (`StandardScaler`) было критически важно для всех методов, основанных на расстояниях.
2.  **Ограничения KMeans:** Алгоритм отлично работает на простых сферических кластерах (Dataset 01), но пасует перед сложной геометрией (Dataset 02) и высокой размерностью.
3.  **Гибкость DBSCAN:** Метод на основе плотности показал себя универсальнее, выиграв на 2 из 3 датасетов. Однако он очень чувствителен к настройке гиперпараметров. "Дефолтные" настройки (`eps=0.5`) не сработали практически нигде.
4.  **Проклятие размерности:** На примере Dataset 04 мы увидели, как с ростом количества признаков растут расстояния между точками, требуя непропорционального увеличения параметра `eps` для DBSCAN.